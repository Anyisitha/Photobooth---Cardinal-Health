{"ast":null,"code":"var _jsxFileName = \"/Users/macuser/Desktop/pothoboot/src/components/CameraScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\nimport SettingsModal from './SettingsModal';\nimport './cameraScreen.css';\nimport './animate.compat.css'; //Variables de configuracion de enfoque y resolucion de la camara\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst facingMode = FACING_MODES.USER;\nconst idealResolution = {\n  width: 640,\n  height: 480\n};\n\nconst CameraScreen = () => {\n  _s();\n\n  const [isCameraReady, setIsCameraReady] = useState(false);\n  const [photoTaken, setPhotoTaken] = useState(false);\n  const [imageToDownload, setImageToDownload] = useState('#');\n  const [showModal, setShowModal] = useState(false);\n  const [isTimerSet, setIsTimerSet] = useState(false);\n  const [isFullScreen, setIsFullScreen] = useState(false);\n  const [counter, setCounter] = useState(3);\n  const [showCounter, setShowCounter] = useState(false); //Crear referencia para tomar el html de video\n\n  const videoRef = useRef();\n  let cameraPhoto = new CameraPhoto(videoRef.current);\n  useEffect(() => {\n    //Instanciar la libreria e iniciar la camara\n    cameraPhoto = new CameraPhoto(videoRef.current);\n    startCamera(facingMode, idealResolution);\n\n    if (window.innerWidth < 1200) {\n      window.addEventListener(\"orientationchange\", e => {\n        const popUp = document.querySelector('.rotatePop');\n\n        if (window.orientation == 0) {\n          popUp.style.display = 'flex';\n        } else {\n          popUp.style.display = 'none';\n        }\n      });\n    }\n  }, []);\n\n  const startCamera = (idealFacingMode, idealResolution) => {\n    cameraPhoto.startCamera(idealFacingMode, idealResolution).then(() => {\n      console.log('camera is started !');\n      setIsCameraReady(true);\n    }).catch(error => {\n      alert(error);\n    });\n  }; // Pintar foto en canvas\n\n\n  const displayPicture = uri => {\n    const canvas = document.getElementById('photo');\n    const ctx = canvas.getContext('2d');\n    const image = new Image();\n\n    image.onload = function () {\n      ctx.drawImage(image, canvas.width * 0.15, 0, 450, 350);\n      const frame = new Image();\n\n      frame.onload = function () {\n        ctx.drawImage(frame, 0, 0, 670, 350);\n        setImageToDownload(canvas.toDataURL('image/jpg'));\n      };\n\n      frame.src = './assets/images/frame.png';\n    };\n\n    image.src = uri;\n  }; // Tomar la foto\n\n\n  const takePhoto = () => {\n    const config = {\n      sizeFactor: 1\n    };\n\n    if (isTimerSet) {\n      //Cuando se activa el temporizador\n      setShowCounter(true);\n      setTimeout(() => {\n        setCounter(2);\n      }, 1000);\n      setTimeout(() => {\n        setCounter(1);\n      }, 2000);\n      setTimeout(() => {\n        const dataUri = cameraPhoto.getDataUri(config);\n        displayPicture(dataUri);\n        setPhotoTaken(true);\n      }, 3000);\n    } else {\n      const dataUri = cameraPhoto.getDataUri(config);\n      displayPicture(dataUri);\n      setPhotoTaken(true);\n    }\n  }; //Reiniciar camara \n\n\n  const restartCamera = () => {\n    // Limpiar canvas, contador de timer y volver a mostrar la camara\n    setPhotoTaken(false);\n    setCounter(3);\n    setShowCounter(false);\n    const canvas = document.getElementById('photo');\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-container_camera animated fadeIn\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"logo-poto1\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"./assets/images/logo.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(RotateDevicePop, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }, this), photoTaken && /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"blue animated fadeInLeft\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"pink\",\n        children: \"\\xA1Te ves genial! \\u2588\\u2588\\u2588\\u2588\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 21\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 72\n      }, this), \"\\u2588\\u2588\\u2588\\u2588 Guarda tu foto\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-wrapper_camera\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"initial-img_camera\",\n        style: {\n          display: photoTaken ? 'none' : 'block'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"./assets/images/frame.png\",\n          alt: \"marco\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          autoPlay: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), showCounter && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"timer_camera\",\n          children: counter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        className: \"animated fadeIn\",\n        id: \"photo\",\n        width: \"650\",\n        height: \"350\",\n        style: {\n          display: photoTaken ? 'block' : 'none'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"logo-poto\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"./assets/images/foto2.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }, this), !photoTaken ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"btns-wrapper_camera\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"div-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"settings-btn_camera\",\n          onClick: () => setShowModal(true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"take-btn_camera\",\n          onClick: takePhoto,\n          disabled: !isCameraReady\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"btns-wrapper_camera\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"div-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"trie\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"try-btn_camera\",\n            onClick: restartCamera\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"guardar\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            id: \"download\",\n            className: \"save-btn_camera\",\n            download: \"selfie\",\n            href: imageToDownload\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 21\n    }, this), showModal && /*#__PURE__*/_jsxDEV(SettingsModal, {\n      setShowModal: setShowModal,\n      isTimerSet: isTimerSet,\n      setIsTimerSet: setIsTimerSet,\n      setIsFullScreen: setIsFullScreen,\n      isFullScreen: isFullScreen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CameraScreen, \"l/c5GiSQiRJ3rMpw1UNG4xz7OBQ=\");\n\n_c = CameraScreen;\n\nconst RotateDevicePop = () => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"rotatePop\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"icon-box\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"icon-wrapper animated shakeX\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"./assets/images/icon.png\",\n          alt: \"rotate\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-box\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Por favor gira tu dispositivo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 230,\n    columnNumber: 9\n  }, this);\n};\n\n_c2 = RotateDevicePop;\nexport default CameraScreen;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CameraScreen\");\n$RefreshReg$(_c2, \"RotateDevicePop\");","map":{"version":3,"sources":["/Users/macuser/Desktop/pothoboot/src/components/CameraScreen.js"],"names":["React","useRef","useEffect","useState","CameraPhoto","FACING_MODES","SettingsModal","facingMode","USER","idealResolution","width","height","CameraScreen","isCameraReady","setIsCameraReady","photoTaken","setPhotoTaken","imageToDownload","setImageToDownload","showModal","setShowModal","isTimerSet","setIsTimerSet","isFullScreen","setIsFullScreen","counter","setCounter","showCounter","setShowCounter","videoRef","cameraPhoto","current","startCamera","window","innerWidth","addEventListener","e","popUp","document","querySelector","orientation","style","display","idealFacingMode","then","console","log","catch","error","alert","displayPicture","uri","canvas","getElementById","ctx","getContext","image","Image","onload","drawImage","frame","toDataURL","src","takePhoto","config","sizeFactor","setTimeout","dataUri","getDataUri","restartCamera","clearRect","RotateDevicePop"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\nimport CameraPhoto, { FACING_MODES } from 'jslib-html5-camera-photo';\r\n\r\nimport SettingsModal from './SettingsModal';\r\n\r\nimport './cameraScreen.css';\r\nimport './animate.compat.css';\r\n\r\n//Variables de configuracion de enfoque y resolucion de la camara\r\nconst facingMode = FACING_MODES.USER;\r\nconst idealResolution = { width: 640, height: 480 };\r\n\r\nconst CameraScreen = () => {\r\n\r\n    const [isCameraReady, setIsCameraReady] = useState(false);\r\n    const [photoTaken, setPhotoTaken] = useState(false);\r\n    const [imageToDownload, setImageToDownload] = useState('#');\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [isTimerSet, setIsTimerSet] = useState(false);\r\n    const [isFullScreen, setIsFullScreen] = useState(false);\r\n    const [counter, setCounter] = useState(3);\r\n    const [showCounter, setShowCounter] = useState(false);\r\n    \r\n\r\n    //Crear referencia para tomar el html de video\r\n    const videoRef = useRef();\r\n    let cameraPhoto = new CameraPhoto(videoRef.current);\r\n\r\n    useEffect(() => {\r\n        //Instanciar la libreria e iniciar la camara\r\n        cameraPhoto = new CameraPhoto(videoRef.current);\r\n        startCamera(facingMode, idealResolution);\r\n            \r\n        if(window.innerWidth < 1200) {\r\n            window.addEventListener(\"orientationchange\", (e) => {\r\n                const popUp = document.querySelector('.rotatePop');\r\n\r\n                if(window.orientation == 0) {\r\n                    popUp.style.display = 'flex';    \r\n                } else {\r\n                    popUp.style.display = 'none';\r\n                }\r\n            });\r\n        }\r\n\r\n    }, [])\r\n\r\n    const startCamera = (idealFacingMode, idealResolution) => {\r\n        cameraPhoto.startCamera(idealFacingMode, idealResolution)\r\n            .then(() => {\r\n                console.log('camera is started !');\r\n                setIsCameraReady(true);\r\n            })\r\n            .catch((error) => {\r\n                alert(error);\r\n            });\r\n    }\r\n\r\n    // Pintar foto en canvas\r\n    const displayPicture = (uri) => {\r\n\r\n        const canvas = document.getElementById('photo');\r\n        const ctx = canvas.getContext('2d');\r\n    \r\n        const image = new Image();\r\n        \r\n        image.onload = function() {\r\n            ctx.drawImage(image, canvas.width * 0.15, 0, 450, 350);\r\n\r\n            const frame = new Image();\r\n        \r\n            frame.onload = function() {\r\n                ctx.drawImage(frame, 0, 0, 670, 350);\r\n                setImageToDownload(canvas.toDataURL('image/jpg'));\r\n            };\r\n\r\n            frame.src = './assets/images/frame.png';\r\n        };\r\n        \r\n        image.src = uri;\r\n\r\n    };\r\n\r\n    // Tomar la foto\r\n    const takePhoto = () => {\r\n        const config = {\r\n            sizeFactor: 1\r\n        };\r\n\r\n        if(isTimerSet) { //Cuando se activa el temporizador\r\n\r\n            setShowCounter(true);\r\n\r\n            setTimeout(() => { setCounter(2) }, 1000);\r\n            setTimeout(() => { setCounter(1) }, 2000);\r\n\r\n            setTimeout(() => {\r\n                const dataUri = cameraPhoto.getDataUri(config);\r\n                \r\n                displayPicture(dataUri);\r\n                setPhotoTaken(true);\r\n            }, 3000);\r\n        } else {\r\n            const dataUri = cameraPhoto.getDataUri(config);\r\n            \r\n            displayPicture(dataUri);\r\n            setPhotoTaken(true);\r\n        }\r\n    }\r\n\r\n    //Reiniciar camara \r\n    const restartCamera = () => {\r\n        // Limpiar canvas, contador de timer y volver a mostrar la camara\r\n        setPhotoTaken(false);\r\n        setCounter(3);\r\n        setShowCounter(false);\r\n\r\n        const canvas = document.getElementById('photo');\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    };\r\n\r\n    return (\r\n        \r\n        \r\n        <div className=\"main-container_camera animated fadeIn\">\r\n            <div className='logo-poto1'>\r\n                <img src=\"./assets/images/logo.png\" />\r\n            </div>\r\n            <RotateDevicePop />\r\n            \r\n            {\r\n                photoTaken && \r\n                <h2 className=\"blue animated fadeInLeft\">\r\n                    <span className=\"pink\">¡Te ves genial! ████</span> <br />\r\n                    ████ Guarda tu foto\r\n                </h2>\r\n            }\r\n\r\n            <div className=\"video-wrapper_camera\">\r\n                <div \r\n                    className=\"initial-img_camera\"\r\n                    style={{ display: photoTaken ? 'none' : 'block' }}\r\n                >\r\n                    <img src=\"./assets/images/frame.png\" alt=\"marco\"/>\r\n                    <video\r\n                        ref={videoRef}\r\n                        autoPlay={true}\r\n                    />  \r\n                    \r\n                    {\r\n                        (showCounter) &&\r\n                        <div className=\"timer_camera\">\r\n                            { counter }\r\n                        </div>\r\n                    }\r\n                </div>\r\n\r\n                <canvas \r\n                    className=\"animated fadeIn\"\r\n                    id=\"photo\" \r\n                    width=\"650\" \r\n                    height=\"350\"\r\n                    style={{ display: photoTaken ? 'block' : 'none' }}\r\n                ></canvas>\r\n            </div>\r\n            <div className='logo-poto'>\r\n                <img src=\"./assets/images/foto2.png\" />\r\n            </div>\r\n\r\n            {\r\n                !photoTaken \r\n                ?\r\n                    <div className=\"btns-wrapper_camera\">\r\n                        <div className=\"div-wrapper\">\r\n                            <button\r\n                                className=\"settings-btn_camera\"\r\n                                onClick={() => setShowModal(true)}\r\n                            ></button>\r\n                            <button\r\n                                className=\"take-btn_camera\"\r\n                                onClick={ takePhoto }\r\n                                disabled={ !isCameraReady }\r\n                            ></button>\r\n                        </div>\r\n                    </div>\r\n                :\r\n                    <div className=\"btns-wrapper_camera\">\r\n                        <div className=\"div-wrapper\">\r\n                            <div className='trie'>\r\n                                <button\r\n                                    className=\"try-btn_camera\"\r\n                                    onClick={ restartCamera }\r\n                                    ></button>\r\n                                {/* <p className=\"blue\">Descarta esta foto <br /> e intenta de nuevo</p> */}\r\n                            </div>\r\n                            <div className='guardar'>\r\n                                <a\r\n                                    id=\"download\"\r\n                                    className=\"save-btn_camera\"\r\n                                    download=\"selfie\"\r\n                                    href={ imageToDownload }\r\n                                ></a>\r\n                                {/* <p className=\"pink\">Guarda tu foto</p> */}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    \r\n            }\r\n\r\n            {/* MODAL DE CONFIGURACIONES */}\r\n            {\r\n                showModal &&\r\n                <SettingsModal \r\n                    setShowModal={ setShowModal } \r\n                    isTimerSet={ isTimerSet }\r\n                    setIsTimerSet={ setIsTimerSet }\r\n                    setIsFullScreen={ setIsFullScreen }\r\n                    isFullScreen={ isFullScreen }\r\n                />\r\n            }\r\n        </div>\r\n    );\r\n};\r\n\r\nconst RotateDevicePop = () => {\r\n    return (\r\n        <div className=\"rotatePop\">\r\n            <div className=\"icon-box\">\r\n                <div className=\"icon-wrapper animated shakeX\">\r\n                    <img src=\"./assets/images/icon.png\" alt=\"rotate\"/>\r\n                </div>\r\n            </div>\r\n            <div className=\"text-box\">\r\n                <p>\r\n                    Por favor gira tu dispositivo\r\n                </p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default CameraScreen;\r\n"]},"metadata":{},"sourceType":"module"}